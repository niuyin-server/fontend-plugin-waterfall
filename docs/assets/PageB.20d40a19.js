import{m as y,M as et,t as S,g as E,p as L,N as nt,l as rt,u as ot,o as p,c as b,F as D,z as P,a as _,A as it,B as st,n as k,q as N,s as at,J as ut,b as j,w as lt,v as g,E as x,O as ct}from"./vendor.f2d4fbe7.js";import{_ as $}from"./index.0c05c534.js";import{l as dt,e as ft,g as gt}from"./api.efcc3c21.js";const mt=({breakpoints:t,wrapperWidth:e,gutter:n,hasAroundGutter:r,initWidth:o})=>{const s=Object.keys(t).map(l=>Number(l)).sort((l,h)=>l-h);let i=e,a=!1;for(const l of s)if(e<=l){i=l,a=!0;break}if(!a)return o;const u=t[i].rowPerView;return r?(e-n)/u-n:(e-(u-1)*n)/u};function ht(t){const e=y(0),n=y(null);et(n,i=>{const a=i[0],{width:u}=a.contentRect;e.value=u});const r=S(()=>mt({wrapperWidth:e.value,breakpoints:t.breakpoints,gutter:t.gutter,hasAroundGutter:t.hasAroundGutter,initWidth:t.width})),o=S(()=>{const i=t.hasAroundGutter?-t.gutter:t.gutter;return Math.floor((e.value+i)/(r.value+t.gutter))}),s=S(()=>{if(t.align==="left")return 0;if(t.align==="center"){const i=t.hasAroundGutter?t.gutter:-t.gutter,a=o.value*(r.value+t.gutter)+i;return(e.value-a)/2}else{const i=t.hasAroundGutter?t.gutter:-t.gutter,a=o.value*(r.value+t.gutter)+i;return e.value-a}});return{waterfallWrapper:n,wrapperWidth:e,colWidth:r,cols:o,offsetX:s}}function B(t,e){return new RegExp(`(^|\\s)${e}(\\s|$)`).test(t.className)}function G(t,e){if(B(t,e))return;const n=t.className.split(/\s+/);n.push(e),t.className=n.join(" ")}const yt=document.createElement("div").style,C=(()=>{const t={standard:"transform",webkit:"webkitTransform",Moz:"MozTransform",O:"OTransform",ms:"msTransform"};for(const e in t){const n=t[e];if(yt[n]!==void 0)return e}return!1})();function O(t){return C===!1?!1:C==="standard"?t:C+t.charAt(0).toUpperCase()+t.substr(1)}const V=O("transform"),M=O("animation-duration"),T=O("animation-delay"),F=O("transition"),U=O("animation-fill-mode");function _t(t,e,n,r,o){const s=y([]),i=y(0),a=c=>{const f=t.hasAroundGutter?c+1:c;return t.gutter*f+e.value*c+r.value},u=()=>{s.value=new Array(n.value).fill(t.hasAroundGutter?t.gutter:0)},l=vt(t);return{wrapperHeight:i,layoutHandle:async()=>new Promise(c=>{u();const f=[];if(o&&o.value&&o.value.childNodes.forEach(d=>{d.className==="waterfall-item"&&f.push(d)}),f.length===0)return!1;for(let d=0;d<f.length;d++){const m=f[d],v=Math.min.apply(null,s.value),w=s.value.indexOf(v),Q=a(w),z=m.style;V&&(z[V]=`translate3d(${Q}px,${v}px, 0)`),z.width=`${e.value}px`,z.visibility="visible";const{height:Z}=m.getBoundingClientRect();s.value[w]+=Z+t.gutter,l(m,()=>{const tt=t.posDuration/1e3;F&&(z[F]=`transform ${tt}s`)})}i.value=Math.max.apply(null,s.value),setTimeout(()=>{c(!0)},t.posDuration)})}}function vt(t){return(e,n)=>{const r=e.firstChild;if(r&&!B(r,t.animationPrefix)){const o=`${t.animationDuration/1e3}s`,s=`${t.animationDelay/1e3}s`,i=r.style;G(r,t.animationPrefix),G(r,t.animationEffect),M&&(i[M]=o),T&&(i[T]=s),U&&(i[U]="both"),n&&setTimeout(()=>{n()},t.animationDuration+t.animationDelay)}}}const pt=typeof window!="undefined"&&window!==null,W=At(),bt=Object.prototype.propertyIsEnumerable,H=Object.getOwnPropertySymbols;function wt(t,...e){return e.map(r=>r.replace(/\[(\w+)\]/g,".$1").split(".").reduce((o,s)=>o&&o[s],t))}function At(){return pt&&"IntersectionObserver"in window&&"IntersectionObserverEntry"in window&&"intersectionRatio"in window.IntersectionObserverEntry.prototype?("isIntersecting"in window.IntersectionObserverEntry.prototype||Object.defineProperty(window.IntersectionObserverEntry.prototype,"isIntersecting",{get(){return this.intersectionRatio>0}}),!0):!1}function I(t){return typeof t=="function"||toString.call(t)==="[object Object]"}function Ot(t){return typeof t=="object"?t===null:typeof t!="function"}function It(t){return t!=="__proto__"&&t!=="constructor"&&t!=="prototype"}function zt(t,...e){if(!I(t))throw new TypeError("expected the first argument to be an object");if(e.length===0||typeof Symbol!="function"||typeof H!="function")return t;for(const n of e){const r=H(n);for(const o of r)bt.call(n,o)&&(t[o]=n[o])}return t}function K(t,...e){let n=0;for(Ot(t)&&(t=e[n++]),t||(t={});n<e.length;n++)if(I(e[n])){for(const r of Object.keys(e[n]))It(r)&&(I(t[r])&&I(e[n][r])?K(t[r],e[n][r]):t[r]=e[n][r]);zt(t,e[n])}return t}function X(t,e){return new Promise((n,r)=>{const o=new Image;o.onload=()=>{n(o)},o.onerror=()=>{r(new Error("Image load error"))},e&&(o.crossOrigin="Anonymous"),o.src=t})}var A;(function(t){t.LOADING="loading",t.LOADED="loaded",t.ERROR="error"})(A||(A={}));const St={rootMargin:"0px",threshold:0},Y="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",Et="";class Lt{constructor(e=!0,n,r=!0){this.lazyActive=!0,this.crossOrigin=!0,this.options={loading:Y,error:Et,observerOptions:St,log:!0,ratioCalculator:(o,s)=>s/o},this._images=new WeakMap,this.lazyActive=e,this.crossOrigin=r,this.config(n)}config(e={}){K(this.options,e),e.ratioCalculator&&(this.options.ratioCalculator=e.ratioCalculator)}mount(e,n,r){const{src:o,loading:s,error:i}=this._valueFormatter(n);e.setAttribute("lazy",A.LOADING),e.setAttribute("src",s||Y),this.lazyActive?(W||(this._setImageSrc(e,o,r,i),this._log(()=>{throw new Error("Not support IntersectionObserver!")})),this._initIntersectionObserver(e,o,r,i)):this._setImageSrc(e,o,r,i)}resize(e,n){const r=e.getAttribute("lazy"),o=e.getAttribute("src");r&&r===A.LOADED&&o&&X(o,this.crossOrigin).then(s=>{const{width:i,height:a}=s,u=e.width/i*a;e.height=u;const l=e.style;l.height=`${u}px`,n()})}unmount(e){const n=this._realObserver(e);n&&n.unobserve(e),this._images.delete(e)}_setImageSrc(e,n,r,o){!n||e.getAttribute("src")===n||X(n,this.crossOrigin).then(i=>{var c,f;const{width:a,height:u}=i,l=((f=(c=this.options).ratioCalculator)==null?void 0:f.call(c,a,u))||u/a,h=e.parentNode.parentNode;h.style.paddingBottom=`${l*100}%`,e.setAttribute("lazy",A.LOADED),e.removeAttribute("src"),e.setAttribute("src",n),r(!0)}).catch(()=>{const i=this._realObserver(e);i&&i.disconnect(),o&&(e.setAttribute("lazy",A.ERROR),e.setAttribute("src",o),r(!1)),this._log(()=>{throw new Error(`Image failed to load!And failed src was: ${n} `)})})}_isOpenLazy(){return W&&this.lazyActive}_initIntersectionObserver(e,n,r,o){const s=this.options.observerOptions;this._images.set(e,new IntersectionObserver(a=>{Array.prototype.forEach.call(a,u=>{if(u.isIntersecting){const l=this._realObserver(e);l&&l.unobserve(u.target),this._setImageSrc(e,n,r,o)}})},s));const i=this._realObserver(e);i&&i.observe(e)}_valueFormatter(e){let n=e,r=this.options.loading,o=this.options.error;return I(e)&&(n=e.src,r=e.loading||this.options.loading,o=e.error||this.options.error),{src:n,loading:r,error:o}}_log(e){this.options.log&&e()}_realObserver(e){return this._images.get(e)}}const R=E({props:{list:{type:Array,default:()=>[]},rowKey:{type:String,default:"id"},imgSelector:{type:String,default:"src"},width:{type:Number,default:200},breakpoints:{type:Object,default:()=>({1200:{rowPerView:3},800:{rowPerView:2},500:{rowPerView:1}})},gutter:{type:Number,default:10},hasAroundGutter:{type:Boolean,default:!0},posDuration:{type:Number,default:300},animationPrefix:{type:String,default:"animate__animated"},animationEffect:{type:String,default:"fadeIn"},animationDuration:{type:Number,default:1e3},animationDelay:{type:Number,default:300},backgroundColor:{type:String,default:"#fff"},lazyload:{type:Boolean,default:!0},loadProps:{type:Object,default:()=>{}},crossOrigin:{type:Boolean,default:!0},delay:{type:Number,default:300},align:{type:String,default:"center"}},setup(t,e){const n=new Lt(t.lazyload,t.loadProps,t.crossOrigin);L("lazy",n);const{waterfallWrapper:r,wrapperWidth:o,colWidth:s,cols:i,offsetX:a}=ht(t),{wrapperHeight:u,layoutHandle:l}=_t(t,s,i,a,r),h=nt(()=>{l().then(()=>{e.emit("afterRender")})},t.delay);rt(()=>[o,s,t.list],()=>{o.value>0&&h()},{deep:!0});const c=y(0);return L("sizeChangeTime",c),L("imgLoaded",h),{waterfallWrapper:r,wrapperHeight:u,getRenderURL:m=>wt(m,t.imgSelector)[0],getKey:(m,v)=>m[t.rowKey]||v,renderer:h}}}),q=()=>{ot(t=>({"84adae44":t.backgroundColor}))},J=R.setup;R.setup=J?(t,e)=>(q(),J(t,e)):q;const $t=R,Ct={class:"waterfall-card"};function Rt(t,e,n,r,o,s){return p(),b("div",{ref:"waterfallWrapper",class:"waterfall-list",style:st({height:`${t.wrapperHeight}px`})},[(p(!0),b(D,null,P(t.list,(i,a)=>(p(),b("div",{key:t.getKey(i,a),class:"waterfall-item"},[_("div",Ct,[it(t.$slots,"item",{item:i,index:a,url:t.getRenderURL(i)},void 0,!0)])]))),128))],4)}var Dt=$($t,[["render",Rt],["__scopeId","data-v-6d3e5303"]]);const Pt=E({props:{url:{type:String,default:""},title:{type:String,default:""},alt:{type:String,default:""}},setup(t,e){const n=k("imgLoaded"),r=k("lazy"),o=y(null);N(()=>{s()}),at(()=>{i()});function s(){!o.value||r.mount(o.value,t.url,u=>{n(),u?e.emit("success",t.url):e.emit("error",t.url)})}function i(){!o.value||r.unmount(o.value)}function a(){e.emit("load",t.url)}return{lazyRef:o,imageLoad:a}}}),kt={class:"lazy__box"},Nt={class:"lazy__resource"},jt=["title","alt"];function xt(t,e,n,r,o,s){return p(),b("div",kt,[_("div",Nt,[_("img",{ref:"lazyRef",class:"lazy__img",title:t.title,alt:t.alt,onLoad:e[0]||(e[0]=(...i)=>t.imageLoad&&t.imageLoad(...i))},null,40,jt)])])}var Bt=$(Pt,[["render",xt],["__scopeId","data-v-640f8d40"]]);const Gt={class:"page-b-content"},Vt={class:"bg-gray-900 rounded-lg shadow-md overflow-hidden transition-all duration-300 ease-linear hover:shadow-lg hover:shadow-gray-600 group"},Mt={class:"overflow-hidden"},Tt={class:"px-4 pt-2 pb-4 border-t border-t-gray-800"},Ft={class:"pb-4 text-gray-50 group-hover:text-yellow-300"},Ut={class:"page-menus"},Wt=["onClick"],Ht=E({setup(t){const e=function(){const c=y([1,2,3,4,5]),f=y(1),d=y([]);function m(w){f.value=w,v()}function v(){gt({page:f.value,pageSize:40}).then(w=>{d.value=w})}return{list:d,page:f,pages:c,handleLoadMore:v,handleChangePage:m}},n=ut({rowKey:"id",gutter:10,hasAroundGutter:!0,width:320,breakpoints:{1200:{rowPerView:4},800:{rowPerView:3},500:{rowPerView:2}},animationEffect:"animate__fadeInUp",animationDuration:1e3,animationDelay:300,backgroundColor:"#2C2E3A",imgSelector:"src.original",loadProps:{loading:dt,error:ft},lazyload:!0,crossOrigin:!0}),{list:r,page:o,pages:s,handleLoadMore:i,handleChangePage:a}=e();N(()=>{i()});function u(c){}function l(c){console.error(`${c}: \u52A0\u8F7D\u5931\u8D25`)}function h(c){}return(c,f)=>(p(),b("div",Gt,[j(g(Dt),{list:g(r),"row-key":g(n).rowKey,gutter:g(n).gutter,"has-around-gutter":g(n).hasAroundGutter,width:g(n).width,breakpoints:g(n).breakpoints,"img-selector":g(n).imgSelector,"background-color":g(n).backgroundColor,lazyload:g(n).lazyload,"load-props":g(n).loadProps},{item:lt(({item:d,url:m})=>[_("div",Vt,[_("div",Mt,[j(g(Bt),{url:m,class:"cursor-pointer transition-all duration-300 ease-linear group-hover:scale-105",onLoad:u,onError:l,onSuccess:h},null,8,["url"])]),_("div",Tt,[_("h2",Ft,x(d.name),1)])])]),_:1},8,["list","row-key","gutter","has-around-gutter","width","breakpoints","img-selector","background-color","lazyload","load-props"]),_("div",Ut,[(p(!0),b(D,null,P(g(s),d=>(p(),b("p",{key:d,class:ct(["page-menus__item",{active:d===g(o)}]),onClick:m=>g(a)(d)},x(d),11,Wt))),128))])]))}});var qt=$(Ht,[["__scopeId","data-v-2cbce89c"]]);export{qt as default};
